CLEANFILES = *~
MAINTAINERCLEANFILES = \
	aclocal.m4 \
	configure \
	Makefile.in \
	config.h \
	config.h.in \
	autoconf/* \
	stamp-* \
	m4/libtool.m4 \
	m4/lt*.m4 \
	poloka.pc

EXTRA_DIST = autogen.sh README README.autotools NEWS INSTALL COPYING

ACLOCAL_AMFLAGS = -I m4

pkgconfigdir = $(libdir)/pkgconfig
pkgconfig_DATA = poloka.pc

SUBDIRS = datacards doc \
	cern_stuff telinst \
	src_base src_utils src \
	flat psf lc simphot utils

if CERNLIB
SUBDIRS += cern_utils
endif

if IMAGEMAGICK
SUBDIRS += imagemagick_utils
endif

dist-hook:
	@if test -d "$(srcdir)/.git"; \
	then \
		echo "Creating ChangeLog" && \
		( cd "$(top_srcdir)" && \
		  echo "# Generated by Makefile. Do not edit."; echo; \
			$(top_srcdir)/autoconf/missing --run git log \
			--date=short --format="%ad%x09%an <%ae> %n%x09* %s%n" ) > ChangeLog.tmp \
		&& mv -f ChangeLog.tmp "$(distdir)/ChangeLog" \
		|| ( rm -f ChangeLog.tmp ; \
		     echo "Failed to generate ChangeLog" >&2 ); \
        else \
		echo "A git clone is required to generate a ChangeLog" >&2; \
        fi
